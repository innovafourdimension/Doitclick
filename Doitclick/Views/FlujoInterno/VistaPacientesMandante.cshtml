
@{
    ViewData["Title"] = "Mis Pacientes";
}

<div class="row">
    <div class="col-lg-12">
        <div id="demo-panel-network" class="panel">
            <div class="panel-heading">
                <h3 class="panel-title">
                    <ol class="breadcrumb">
                        <li></li>
                        <li class="active">Cotizaciones de mis Pacientes</li>
                    </ol>
                </h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-sm-12 col-md-12">
                        <table id="tabla-generica" data-toggle="table"
                                        data-url="/api/flujo-interno/cotizaciones-all"
                                        data-search="true"
                                        data-show-refresh="false"
                                        data-show-toggle="false"
                                        data-show-columns="false"
                                        data-sort-name="solicitud.numeroTicket"
                                        data-page-list="[]"
                                        data-page-size="20"
                                        data-pagination="true" 
                                        data-show-pagination-switch="false"
                                        data-side-pagination="server">
                            <thead>
                                <tr>
                                    <th data-field="solicitud.numeroTicket" data-align="center" data-sortable="true">Nro Ticket</th>
                                    <th data-field="cotizacion.cliente.rut" data-align="center" data-sortable="true" data-formatter="formatoPaciente">Paciente</th>
                                    <th data-field="solicitud.fechaInicio" data-sortable="true" data-align="center" data-formatter="formatoFecha">Fecha Inicio</th>
                                    <th data-field="solicitud.fechaTermino" data-align="center" data-sortable="true" data-formatter="formatoFecha">Fecha Cierre</th>
                                    <th data-field="etapa" data-align="center" data-sortable="true" data-formatter="formatoEtapa">Etapa</th>
                                    <th data-field="solicitud.id" data-align="center" data-sortable="true" data-formatter="formatoSolicitante">Solicitante</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-5">
    </div>
</div>

@section styles{ 
    <link href="~/Assets/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet" />
}
@section Scripts{
    <script src="~/Assets/plugins/bootstrap-table/bootstrap-table.min.js"></script>
    <script>

        function formatoEtapa(val, row, inc){
            //return row.solicitud.tareas.find(e => e.estado === 'Activada').nombre;
            return 'Hola';
        }

        function formatoFecha(valor) {
            if(valor != null){
                return new Date(valor).toChileanDateTimeString();
            }else{
                return  '-';
            }
            
        }

        function formatoPaciente(val, row, inc){
            return  val + ", " + row.cotizacion.cliente.nombres;
        }

        function formatoSolicitante(val, row, inc){
            return  row.cotizacion.drSolicitante + ", Folio: " + row.cotizacion.folioSolicitante;
        }
    </script>

}